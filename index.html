<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BooQ - 智能题库生成器</title>
    <!-- Bootstrap CSS from BootCDN -->
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.bootcdn.net/ajax/libs/bootstrap-icons/1.11.2/font/bootstrap-icons.min.css" rel="stylesheet">
    <!-- KaTeX CSS -->
    <link href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./src/styles/main.css">
</head>
<body>
    <div id="app">
        <!-- 自定义标题栏 -->
        <header class="titlebar">
            <div class="titlebar-left" data-tauri-drag-region>
                <span class="app-logo">📚</span>
                <span class="app-title">BooQ</span>
                <span class="app-subtitle">智能题库生成器</span>
            </div>
            <div class="titlebar-right">
                <button class="titlebar-btn" id="btn-theme" title="切换主题">
                    <i class="bi bi-circle-half"></i>
                </button>
                <button class="titlebar-btn" id="btn-settings" title="设置">
                    <i class="bi bi-gear"></i>
                </button>
                <button class="titlebar-btn" id="btn-minimize" title="最小化">
                    <i class="bi bi-dash-lg"></i>
                </button>
                <button class="titlebar-btn" id="btn-maximize" title="最大化">
                    <i class="bi bi-square"></i>
                </button>
                <button class="titlebar-btn titlebar-close" id="btn-close" title="关闭">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
        </header>

        <!-- 主内容区 -->
        <main class="main-content">
            <!-- 左侧：文件书架 -->
            <aside class="sidebar sidebar-left">
                <div class="sidebar-header">
                    <h3>文件书架</h3>
                    <button class="btn btn-sm btn-primary" id="btn-upload" title="上传文件">
                        <i class="bi bi-plus-lg"></i>
                    </button>
                </div>
                <div class="file-list" id="file-list">
                    <!-- 文件列表将通过 JS 动态生成 -->
                    <div class="empty-state">
                        <i class="bi bi-folder2-open"></i>
                        <p>暂无文件</p>
                        <p class="text-muted">点击上方按钮上传文件</p>
                    </div>
                </div>
            </aside>

            <!-- 中间：预览窗口 -->
            <section class="preview-panel">
                <div class="preview-header">
                    <div class="preview-tabs">
                        <button class="tab-btn active" data-mode="source">源文件</button>
                        <button class="tab-btn" data-mode="markdown">MD文件</button>
                        <button class="tab-btn" data-mode="code">代码文件</button>
                    </div>
                    <div class="preview-actions">
                        <button class="btn btn-sm btn-outline-secondary" id="btn-refresh-ocr" title="重新识别当前页">
                            <i class="bi bi-arrow-clockwise"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-primary" id="btn-convert-md" title="转换为Markdown">
                            <i class="bi bi-file-earmark-text"></i> 转换成Markdown格式
                        </button>
                        <button class="btn btn-sm btn-outline-success" id="btn-start-analysis" title="开始分析">
                            <i class="bi bi-play-fill"></i> 开始分析
                        </button>
                    </div>
                </div>
                <div class="preview-content" id="preview-content">
                    <div class="empty-state">
                        <i class="bi bi-file-earmark-richtext"></i>
                        <p>选择左侧文件进行预览</p>
                    </div>
                </div>
                <div class="preview-footer">
                    <div class="page-navigation">
                        <button class="btn btn-sm btn-outline-secondary" id="btn-prev-page" disabled>
                            <i class="bi bi-chevron-left"></i>
                        </button>
                        <span class="page-info">
                            <input type="number" id="input-page" class="page-input" value="1" min="1">
                            <span> / </span>
                            <span id="total-pages">1</span>
                        </span>
                        <button class="btn btn-sm btn-outline-secondary" id="btn-next-page" disabled>
                            <i class="bi bi-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- 右侧：输出窗口 -->
            <aside class="sidebar sidebar-right">
                <div class="sidebar-header">
                    <h3>题库输出</h3>
                    <span class="question-count" id="question-count">0 题</span>
                </div>
                <div class="question-panel" id="question-panel">
                    <div class="empty-state">
                        <i class="bi bi-journal-text"></i>
                        <p>暂无题目</p>
                        <p class="text-muted">上传文件并开始分析后，题目将在这里展示</p>
                    </div>
                </div>
                <div class="question-navigation" id="question-navigation" style="display: none;">
                    <button class="btn btn-sm btn-outline-secondary" id="btn-prev-question">
                        <i class="bi bi-chevron-left"></i> 上一题
                    </button>
                    <span class="question-index" id="question-index">1 / 1</span>
                    <button class="btn btn-sm btn-outline-secondary" id="btn-next-question">
                        下一题 <i class="bi bi-chevron-right"></i>
                    </button>
                </div>
                <div class="analysis-progress" id="analysis-progress" style="display: none;">
                    <div class="progress">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" 
                             role="progressbar" style="width: 0%"></div>
                    </div>
                    <p class="progress-text" id="progress-text">准备分析中...</p>
                </div>
            </aside>
        </main>

        <!-- 右键菜单 -->
        <div class="context-menu" id="context-menu" style="display: none;">
            <div class="context-menu-item" data-action="copy">
                <i class="bi bi-clipboard"></i> 复制
            </div>
            <div class="context-menu-item" data-action="paste">
                <i class="bi bi-clipboard-check"></i> 粘贴
            </div>
            <div class="context-menu-divider"></div>
            <div class="context-menu-item" data-action="rename">
                <i class="bi bi-pencil"></i> 重命名
            </div>
            <div class="context-menu-item" data-action="delete" style="color: var(--danger-color);">
                <i class="bi bi-trash"></i> 删除
            </div>
        </div>

        <!-- 设置弹窗 -->
        <div class="modal-overlay" id="settings-modal" style="display: none;">
            <div class="modal-dialog modal-lg">
                <div class="modal-header">
                    <h4>设置</h4>
                    <span class="modal-subtitle">集中管理模型与数据策略</span>
                    <button class="btn-close-modal" id="btn-close-settings">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
                <div class="settings-container">
                    <!-- 左侧导航 -->
                    <div class="settings-sidebar">
                        <div class="settings-nav-item active" data-section="general">
                            <i class="bi bi-gear"></i>
                            <div class="nav-item-content">
                                <span class="nav-item-title">常规设置</span>
                                <span class="nav-item-desc">主题与存储配置</span>
                            </div>
                        </div>
                        <div class="settings-nav-item" data-section="models">
                            <i class="bi bi-cpu"></i>
                            <div class="nav-item-content">
                                <span class="nav-item-title">模型选择</span>
                                <span class="nav-item-desc">管理模型供应商</span>
                            </div>
                        </div>
                        <div class="settings-nav-item" data-section="workflow">
                            <i class="bi bi-diagram-3"></i>
                            <div class="nav-item-content">
                                <span class="nav-item-title">工作流配置</span>
                                <span class="nav-item-desc">配置分析流程</span>
                            </div>
                        </div>
                        <div class="settings-nav-item" data-section="tools">
                            <i class="bi bi-tools"></i>
                            <div class="nav-item-content">
                                <span class="nav-item-title">工具部署</span>
                                <span class="nav-item-desc">OCR 工具配置</span>
                            </div>
                        </div>
                        <div class="settings-nav-item" data-section="logs">
                            <i class="bi bi-journal-text"></i>
                            <div class="nav-item-content">
                                <span class="nav-item-title">运行日志</span>
                                <span class="nav-item-desc">查看系统日志</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 右侧内容区 -->
                    <div class="settings-content">
                        <!-- 常规设置 -->
                        <div class="settings-section-panel active" id="section-general">
                            <div class="settings-section">
                                <h5>存储设置</h5>
                                <div class="form-group">
                                    <label>文件存储路径</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="input-storage-path" readonly>
                                        <button class="btn btn-outline-secondary" id="btn-browse-path">
                                            <i class="bi bi-folder2"></i> 浏览
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="settings-section">
                                <h5>主题设置</h5>
                                <div class="theme-options">
                                    <label class="theme-option">
                                        <input type="radio" name="theme" value="light">
                                        <span><i class="bi bi-sun"></i> 白天模式</span>
                                    </label>
                                    <label class="theme-option">
                                        <input type="radio" name="theme" value="dark">
                                        <span><i class="bi bi-moon"></i> 夜间模式</span>
                                    </label>
                                    <label class="theme-option">
                                        <input type="radio" name="theme" value="system" checked>
                                        <span><i class="bi bi-circle-half"></i> 跟随系统</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- 模型选择 -->
                        <div class="settings-section-panel" id="section-models">
                            <div class="model-config-header">
                                <h5>已配置的模型</h5>
                                <div class="model-list" id="model-list">
                                    <!-- 模型列表将通过 JS 动态生成 -->
                                </div>
                            </div>
                            
                            <div class="provider-grid-section">
                                <h5>选择模型供应商</h5>
                                <div class="provider-grid" id="provider-grid">
                                    <!-- 供应商卡片 -->
                                    <div class="provider-card" data-provider="openai">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/openai.png" alt="OpenAI" class="provider-icon">
                                        <span class="provider-name">OpenAI</span>
                                    </div>
                                    <div class="provider-card" data-provider="anthropic">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/anthropic.png" alt="Anthropic" class="provider-icon">
                                        <span class="provider-name">Anthropic</span>
                                    </div>
                                    <div class="provider-card" data-provider="gemini">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/gemini.png" alt="Google Gemini" class="provider-icon">
                                        <span class="provider-name">Google Gemini</span>
                                    </div>
                                    <div class="provider-card" data-provider="deepseek">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/deepseek.png" alt="DeepSeek" class="provider-icon">
                                        <span class="provider-name">DeepSeek</span>
                                    </div>
                                    <div class="provider-card" data-provider="zhipu">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/zhipu.png" alt="智谱AI" class="provider-icon">
                                        <span class="provider-name">智谱AI</span>
                                    </div>
                                    <div class="provider-card" data-provider="qwen">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/qwen.png" alt="通义千问" class="provider-icon">
                                        <span class="provider-name">通义千问</span>
                                    </div>
                                    <div class="provider-card" data-provider="moonshot">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/moonshot.png" alt="Moonshot" class="provider-icon">
                                        <span class="provider-name">Moonshot</span>
                                    </div>
                                    <div class="provider-card" data-provider="ollama">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/ollama.png" alt="Ollama" class="provider-icon">
                                        <span class="provider-name">Ollama</span>
                                    </div>
                                    <div class="provider-card" data-provider="siliconcloud">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/siliconcloud.png" alt="硅基流动" class="provider-icon">
                                        <span class="provider-name">硅基流动</span>
                                    </div>
                                    <div class="provider-card" data-provider="doubao">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/doubao.png" alt="豆包" class="provider-icon">
                                        <span class="provider-name">豆包</span>
                                    </div>
                                    <div class="provider-card" data-provider="groq">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/groq.png" alt="Groq" class="provider-icon">
                                        <span class="provider-name">Groq</span>
                                    </div>
                                    <div class="provider-card" data-provider="azure">
                                        <img src="https://registry.npmmirror.com/@lobehub/icons-static-png/latest/files/light/azure.png" alt="Azure" class="provider-icon">
                                        <span class="provider-name">Azure OpenAI</span>
                                    </div>
                                    <div class="provider-card add-custom" data-provider="custom">
                                        <i class="bi bi-plus-lg"></i>
                                        <span class="provider-name">自定义模型</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 工作流配置 -->
                        <div class="settings-section-panel" id="section-workflow">
                            <div class="settings-section">
                                <h5>工作流配置</h5>
                                <p class="section-desc">为不同任务分配不同的模型，以获得最佳效果</p>
                                <div class="form-group">
                                    <label>阅读模型</label>
                                    <select class="form-select" id="select-reading-model">
                                        <option value="">请先添加模型</option>
                                    </select>
                                    <small class="form-text">用于阅读和理解文档内容</small>
                                </div>
                                <div class="form-group">
                                    <label>分析模型</label>
                                    <select class="form-select" id="select-analysis-model">
                                        <option value="">请先添加模型</option>
                                    </select>
                                    <small class="form-text">用于分析和提取题目</small>
                                </div>
                                <div class="form-group">
                                    <label>解题模型</label>
                                    <select class="form-select" id="select-solving-model">
                                        <option value="">请先添加模型</option>
                                    </select>
                                    <small class="form-text">用于生成题目答案和解析</small>
                                </div>
                            </div>
                        </div>

                        <!-- 工具部署 -->
                        <div class="settings-section-panel" id="section-tools">
                            <div class="settings-section">
                                <h5>MinerU 本地 OCR 工具</h5>
                                <p class="section-desc">使用 MinerU 进行本地文档解析，无需联网，无使用限额。需要按顺序完成：1. 安装模块 → 2. 安装依赖 → 3. 下载模型 → 4. 配置</p>
                                
                                <!-- Step 1: 安装 MinerU 模块 -->
                                <div class="tool-card">
                                    <div class="tool-info">
                                        <div class="tool-header">
                                            <div class="step-number">1</div>
                                            <div class="tool-title">
                                                <span class="tool-name">安装 MinerU 模块</span>
                                                <span class="tool-badge" id="mineru-status-badge">未安装</span>
                                            </div>
                                        </div>
                                        <p class="tool-desc">安装 magic-pdf Python 包，这是 MinerU 的核心组件。需要 Python 3.10+ 环境。</p>
                                        
                                        <!-- 路径信息 -->
                                        <div class="mineru-path-info" id="mineru-path-info" style="display: none;">
                                            <div class="path-row">
                                                <span class="path-label">可执行文件：</span>
                                                <code class="path-value" id="mineru-exe-path">-</code>
                                            </div>
                                            <div class="path-status" id="mineru-path-status">
                                                <i class="bi bi-check-circle-fill text-success"></i>
                                                <span>命令可用</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tool-actions">
                                        <button class="btn btn-primary" id="btn-install-mineru">
                                            <i class="bi bi-download"></i> 安装 MinerU
                                        </button>
                                        <button class="btn btn-outline-secondary" id="btn-check-mineru">
                                            <i class="bi bi-arrow-repeat"></i> 检测
                                        </button>
                                    </div>
                                    <!-- 终端输出区域 -->
                                    <div class="terminal-container" id="terminal-container" style="display: none;">
                                        <div class="terminal-header">
                                            <span class="terminal-title"><i class="bi bi-terminal"></i> 终端输出</span>
                                            <button class="btn-terminal-close" id="btn-close-terminal">
                                                <i class="bi bi-x"></i>
                                            </button>
                                        </div>
                                        <div class="terminal-output" id="terminal-output"></div>
                                    </div>
                                </div>

                                <!-- Step 2: 安装 modelscope 依赖 -->
                                <div class="tool-card">
                                    <div class="tool-info">
                                        <div class="tool-header">
                                            <div class="step-number">2</div>
                                            <div class="tool-title">
                                                <span class="tool-name">安装模型下载工具</span>
                                                <span class="tool-badge" id="modelscope-badge">未安装</span>
                                            </div>
                                        </div>
                                        <p class="tool-desc">安装 ModelScope 依赖，用于从国内镜像源下载 MinerU 模型。</p>
                                    </div>
                                    <div class="tool-actions">
                                        <button class="btn btn-primary" id="btn-install-modelscope">
                                            <i class="bi bi-download"></i> 安装 ModelScope
                                        </button>
                                    </div>
                                    <!-- ModelScope 安装终端输出区域 -->
                                    <div class="terminal-container" id="modelscope-terminal-container" style="display: none;">
                                        <div class="terminal-header">
                                            <span class="terminal-title"><i class="bi bi-terminal"></i> 安装进度</span>
                                            <button class="btn-terminal-close" id="btn-close-modelscope-terminal">
                                                <i class="bi bi-x"></i>
                                            </button>
                                        </div>
                                        <div class="terminal-output" id="modelscope-terminal-output"></div>
                                    </div>
                                </div>

                                <!-- Step 3: 下载模型 -->
                                <div class="tool-card">
                                    <div class="tool-info">
                                        <div class="tool-header">
                                            <div class="step-number">3</div>
                                            <div class="tool-title">
                                                <span class="tool-name">下载 MinerU 模型</span>
                                            </div>
                                        </div>
                                        <p class="tool-desc">模型将下载到 BooQ 存储路径。请先在"常规设置"中配置存储路径。</p>
                                        
                                        <div class="model-storage-info">
                                            <span class="storage-label">模型存储目录：</span>
                                            <code class="storage-path" id="mineru-models-dir">未配置</code>
                                        </div>

                                        <!-- 主模型 -->
                                        <div class="model-item-card">
                                            <div class="model-item-header">
                                                <i class="bi bi-box-seam model-icon"></i>
                                                <div class="model-item-info">
                                                    <span class="model-item-name">MinerU 2.5 主模型 (1.2B)</span>
                                                    <span class="model-item-size">约 2.5GB</span>
                                                </div>
                                                <span class="tool-badge" id="main-model-badge">未下载</span>
                                            </div>
                                            <p class="model-item-desc">布局分析和文档结构识别的核心模型，必须下载。</p>
                                            <div class="model-item-actions">
                                                <button class="btn btn-primary btn-sm" id="btn-download-main-model">
                                                    <i class="bi bi-download"></i> 下载主模型
                                                </button>
                                            </div>
                                            <!-- 主模型下载终端 -->
                                            <div class="terminal-container" id="main-model-terminal-container" style="display: none;">
                                                <div class="terminal-header">
                                                    <span class="terminal-title"><i class="bi bi-terminal"></i> 下载进度</span>
                                                    <button class="btn-terminal-close" id="btn-close-main-model-terminal">
                                                        <i class="bi bi-x"></i>
                                                    </button>
                                                </div>
                                                <div class="terminal-output" id="main-model-terminal-output"></div>
                                            </div>
                                        </div>

                                        <!-- OCR 模型 -->
                                        <div class="model-item-card">
                                            <div class="model-item-header">
                                                <i class="bi bi-eye model-icon"></i>
                                                <div class="model-item-info">
                                                    <span class="model-item-name">PDF-Extract-Kit OCR 模型</span>
                                                    <span class="model-item-size">约 1.5GB</span>
                                                </div>
                                                <span class="tool-badge" id="ocr-model-badge">未下载</span>
                                            </div>
                                            <p class="model-item-desc">OCR 文字识别模型，用于扫描件和模糊文档，可选下载。</p>
                                            <div class="model-item-actions">
                                                <button class="btn btn-outline-primary btn-sm" id="btn-download-ocr-model">
                                                    <i class="bi bi-download"></i> 下载 OCR 模型
                                                </button>
                                            </div>
                                            <!-- OCR 模型下载终端 -->
                                            <div class="terminal-container" id="ocr-model-terminal-container" style="display: none;">
                                                <div class="terminal-header">
                                                    <span class="terminal-title"><i class="bi bi-terminal"></i> 下载进度</span>
                                                    <button class="btn-terminal-close" id="btn-close-ocr-model-terminal">
                                                        <i class="bi bi-x"></i>
                                                    </button>
                                                </div>
                                                <div class="terminal-output" id="ocr-model-terminal-output"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Step 4: 配置 -->
                                <div class="tool-card">
                                    <div class="tool-info">
                                        <div class="tool-header">
                                            <div class="step-number">4</div>
                                            <div class="tool-title">
                                                <span class="tool-name">配置 MinerU</span>
                                            </div>
                                        </div>
                                        <p class="tool-desc">更新 MinerU 配置文件，使其使用已下载的模型。完成此步骤后即可使用 MinerU 进行文档解析。</p>
                                    </div>
                                    <div class="tool-actions">
                                        <button class="btn btn-success" id="btn-update-mineru-config" disabled>
                                            <i class="bi bi-gear"></i> 应用配置
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="settings-section">
                                <div class="section-header-with-toggle">
                                    <h5>PaddleOCR-VL API（可选）</h5>
                                    <label class="toggle-label">
                                        <input type="checkbox" id="toggle-paddle-ocr">
                                        <span class="toggle-switch"></span>
                                    </label>
                                </div>
                                <p class="section-desc">使用百度 PaddleOCR-VL API 进行高精度文档解析，需要配置 API 密钥</p>
                                
                                <div class="paddle-ocr-config" id="paddle-ocr-config">
                                    <div class="form-group">
                                        <label>API URL</label>
                                        <input type="text" class="form-control" id="input-paddle-url" 
                                               placeholder="https://paddleocr.ai/api/v1/parse">
                                    </div>
                                    <div class="form-group">
                                        <label>API Token</label>
                                        <input type="password" class="form-control" id="input-paddle-token" 
                                               placeholder="your-api-token">
                                    </div>
                                    <button class="btn btn-outline-primary btn-sm" id="btn-test-paddle">
                                        <i class="bi bi-play-circle"></i> 测试连接
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- 运行日志 -->
                        <div class="settings-section-panel" id="section-logs">
                            <div class="settings-section">
                                <div class="section-header-with-toggle">
                                    <h5>运行日志</h5>
                                    <div class="log-actions">
                                        <button class="btn btn-outline-secondary btn-sm" id="btn-refresh-logs">
                                            <i class="bi bi-arrow-clockwise"></i> 刷新
                                        </button>
                                        <button class="btn btn-outline-danger btn-sm" id="btn-clear-logs">
                                            <i class="bi bi-trash"></i> 清空
                                        </button>
                                    </div>
                                </div>
                                <p class="section-desc">查看系统运行时产生的日志信息，便于调试和排查问题</p>
                                
                                <div class="log-filter">
                                    <label class="log-filter-item">
                                        <input type="checkbox" class="log-filter-check" data-level="info" checked> 
                                        <span class="log-level-badge level-info">INFO</span>
                                    </label>
                                    <label class="log-filter-item">
                                        <input type="checkbox" class="log-filter-check" data-level="warn" checked> 
                                        <span class="log-level-badge level-warn">WARN</span>
                                    </label>
                                    <label class="log-filter-item">
                                        <input type="checkbox" class="log-filter-check" data-level="error" checked> 
                                        <span class="log-level-badge level-error">ERROR</span>
                                    </label>
                                    <label class="log-filter-item">
                                        <input type="checkbox" class="log-filter-check" data-level="debug"> 
                                        <span class="log-level-badge level-debug">DEBUG</span>
                                    </label>
                                </div>
                                
                                <div class="log-container" id="log-container">
                                    <div class="log-empty">暂无日志记录</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="btn-cancel-settings">取消</button>
                    <button class="btn btn-primary" id="btn-save-settings">保存</button>
                </div>
            </div>
        </div>

        <!-- 添加模型弹窗 -->
        <div class="modal-overlay" id="add-model-modal" style="display: none;">
            <div class="modal-dialog modal-sm">
                <div class="modal-header">
                    <div class="modal-header-left">
                        <img src="" alt="" class="modal-provider-icon" id="modal-provider-icon">
                        <h4 id="add-model-title">添加模型</h4>
                    </div>
                    <button class="btn-close-modal" id="btn-close-add-model">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>模型名称 <span class="required">*</span></label>
                        <input type="text" class="form-control" id="input-model-name" placeholder="例如：GPT-4">
                    </div>
                    <div class="form-group" id="provider-select-group" style="display: none;">
                        <label>服务商</label>
                        <select class="form-select" id="select-model-provider">
                            <option value="openai">OpenAI</option>
                            <option value="azure">Azure OpenAI</option>
                            <option value="anthropic">Anthropic</option>
                            <option value="gemini">Google Gemini</option>
                            <option value="deepseek">DeepSeek</option>
                            <option value="zhipu">智谱AI</option>
                            <option value="qwen">通义千问</option>
                            <option value="moonshot">Moonshot</option>
                            <option value="ollama">Ollama</option>
                            <option value="siliconcloud">硅基流动</option>
                            <option value="doubao">豆包</option>
                            <option value="groq">Groq</option>
                            <option value="custom">自定义</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>API URL <span class="required">*</span></label>
                        <input type="text" class="form-control" id="input-model-url" 
                               placeholder="https://api.openai.com/v1/chat/completions">
                    </div>
                    <div class="form-group" id="api-key-group">
                        <label>API Key <span class="required">*</span></label>
                        <input type="password" class="form-control" id="input-model-key" 
                               placeholder="sk-xxx...">
                    </div>
                    <div class="form-group">
                        <label>模型标识 <span class="required">*</span></label>
                        <input type="text" class="form-control" id="input-model-id" 
                               placeholder="gpt-4-turbo-preview">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-primary" id="btn-test-model">
                        <i class="bi bi-play-circle"></i> 测试连接
                    </button>
                    <div class="flex-spacer"></div>
                    <button class="btn btn-secondary" id="btn-cancel-add-model">取消</button>
                    <button class="btn btn-primary" id="btn-confirm-add-model">添加</button>
                </div>
            </div>
        </div>

        <!-- 确认删除弹窗 -->
        <div class="modal-overlay" id="delete-confirm-modal" style="display: none;">
            <div class="modal-dialog modal-sm">
                <div class="modal-header">
                    <h4>确认删除</h4>
                </div>
                <div class="modal-body">
                    <p>确定要删除这个文件吗？此操作不可恢复。</p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="btn-cancel-delete">取消</button>
                    <button class="btn btn-danger" id="btn-confirm-delete">删除</button>
                </div>
            </div>
        </div>

        <!-- 重命名弹窗 -->
        <div class="modal-overlay" id="rename-modal" style="display: none;">
            <div class="modal-dialog modal-sm">
                <div class="modal-header">
                    <h4>重命名</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>新名称</label>
                        <input type="text" class="form-control" id="input-new-name">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="btn-cancel-rename">取消</button>
                    <button class="btn btn-primary" id="btn-confirm-rename">确定</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/marked/11.1.1/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        // 设置 PDF.js worker
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        }
    </script>
    <script type="module" src="./src/main.ts"></script>
</body>
</html>
